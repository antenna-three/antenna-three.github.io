---
title: FGO周回ソルバーの仕組み
date: 2021/11/21
draft: true
---

## はじめに

FGOの欲しい素材をもとに効率的なフリークエストの組み合わせを求めるサイト、[FGO周回ソルバー](https://fgo-farming-solver.vercel.app)の仕組みについて解説していきます。

## 数理計画

FGO周回ソルバーの目的は次の通りです。

すべてのアイテムドロップ数がアイテム必要数以上となる条件のもとで、クエスト周回数/消費APがなるべく小さくなるような、クエスト周回数の組み合わせを求める。

このように、ある条件のもとで最もよい値を選ぶ問題を、最適化問題あるいは数理計画問題と呼びます。

最適化問題の身近な例として、マップアプリの経路案内があります。経路案内では、複数の交通手段の中から移動時間や交通費、乗り換え回数などを最小化するような経路を求めます。他の例としては、工場の生産や在庫の調整なども数理計画問題です。

## 線形計画

FGO周回ソルバーの目的を、数学的にもう少し厳密に書いてみましょう。アイテム{% katex %}i{% endkatex %}の必要数を{% katex %}n_i{% endkatex %}、クエスト{% katex %}q{% endkatex %}の周回数を{% katex %}r_q{% endkatex %}、クエスト{% katex %}q{% endkatex %}におけるアイテム{% katex %}i{% endkatex %}のドロップ率を{% katex %}d_qi{% endkatex %}とすると、FGO周回ソルバーが扱う問題は次のようになります。

すべてのアイテム{% katex %}i{% endkatex %}に対して

{% katex %}

\sum_q d_{qi} r_q \ge n_i

{% endkatex %}

を満たし、

{% katex %}

\sum_q r_q

{% endkatex %}

を最小化するような{% katex %}r_q{% endkatex %}を求める。

